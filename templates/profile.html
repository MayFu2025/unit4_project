<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>[PLATFORM] {{ username }}'s Profile</title>
</head>
<body>
    <div id="sidebar">
        <h2>Navigate:</h2>
        <a href="{{ url_for('home') }}">Home</a>
        <a href="{{ url_for('all_categories') }}">All Categories</a>

        <h3>Your Following Categories:</h3>
        {% for cat_id in categories[0] %}
            <a href="{{url_for('get_category', cat_id=cat_id)}}">{{ categories[1][loop.index0] }}</a>
        {% endfor %}
        <div> <!--After the fade out, permanently anchored to bottom-->
            <a href="{{ url_for('get_profile', user_id=user_id) }}">Profile</a>
            <a href="{{ url_for('logout') }}">Logout</a>
        </div>
    </div>

    {% if is_self != True %}
    <div> <!-- Profile Section -->
        <h1>Profile</h1>
        <div> <!-- Image on the right -->
            <img src="{{ user[2] }}" alt="Profile Picture">
            <h2>{{ user[1] }}</h2>
            {% if user[0] in following_u %}
                <button>Follow</button>
            {% else %}
                <button>Unfollow</button>
            {% endif %}
        </div>

    {% else %}
    <div> <!-- Profile Section -->
        <h1>Profile</h1>
        <div> <!-- Image on the right -->
            <img src="{{ pfp }}" alt="Profile Picture">
        </div>
        <div> <!-- Profile Info on the left -->
            <p>Username: {{ username }}
            <p>Name: {{ name }}</p>
            <p>Email: {{ email }}</p>
            <button>Edit</button>
        </div>
    </div>

    <div> <!-- Following Categories/Posts Section -->
        <h1>Following and Saved</h1>

        <div> <!-- Following Categories -->
            <h2>Following Categories</h2>
            {% for category in categories[0] %}
            <div> <!-- Make the background for each category card the category photo -->
                <a href='{{ url_for('get_category', cat_id=category)}}'><h3>{{ categories[1][loop.index0] }}</h3></a>
                <button>Unfollow</button> <!-- Unfollow button to be anchored to right -->
            </div>
            {% endfor %}
        </div>

        <div>
            <h2>Saved Posts</h2>
            {% for post in saved_posts %}
                <div id="post_prev"> <!--Post Preview-->
                    <div id="post_image"> <!--Post Image-->
                        <img src="{{ post.image }}" alt="Post Image">
                    </div>
                    <a href="{{url_for('get_category', cat_id=post[5])}}">{{ post[6] }}</a> <!--Post Category-->
                     <a href="{{url_for('get_post', post_id=post[0])}}"><h3>{{ post[4] }}</h3></a><!--Post Title-->
                    <p>Posted by <a href="{{ url_for('get_profile',user_id=post[7])}}">{{ post[8] }}</a> on {{ post[1] }}</p>  <!--Meant to be author-->
                    <p>{{ post[2] }} saves and {{ post[3] }} comments</p>
                </div>
            {% endfor %}
        </div>
    
        <div>
            <h2>Following Users</h2>
            {% for user in following_u %}
            <div class="profile_card">
                <img src="{{ user[2] }}" alt="profile picture of {{ user[1] }}">
                <a href='{{ url_for('get_profile', user_id=user[0])}}'><h3>{{ user[1] }}</h3></a> <!-- Need to retrieve name shit-->
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <div> <!-- Posts by user -->
        <h1>Posts by {{ user[1] }}</h1>
        {% for post in posts %}
                <div id="post_prev"> <!--Post Preview-->
                    <div id="post_image"> <!--Post Image-->
                        <img src="{{ post.image }}" alt="Post Image">
                    </div>
                    <a href="{{url_for('get_category', cat_id=post[5])}}">{{ post[6] }}</a> <!--Post Category-->
                     <a href="{{url_for('get_post', post_id=post[0])}}"><h3>{{ post[4] }}</h3></a><!--Post Title-->
                    <p>Posted by <a href="{{ url_for('get_profile',user_id=post[7])}}">{{ post[8] }}</a> on {{ post[1] }}</p>  <!--Meant to be author-->
                    <p>{{ post[2] }} saves and {{ post[3] }} comments</p>
                </div>
            {% endfor %}
    </div>
</body>
</html>